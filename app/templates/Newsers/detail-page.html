{% block content %}
<div class="article-container">
    <div class="article-header">
        <h1 class="article-title animated fadeInDown">{{ article.title }}</h1>
        <div class="article-meta animated fadeInUp" style="color: #333;">
            <p class="meta-item">
                <svg class="icon icon-user" viewBox="0 0 24 24">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
                <span>{{ article.author_name }}</span>
            </p>
            <p class="meta-item">
                <svg class="icon icon-calendar" viewBox="0 0 24 24">
                    <path d="M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"/>
                </svg>
                <span>{{ article.created_at }}</span>
            </p>
            <p class="meta-item">
                <svg class="icon icon-tag" viewBox="0 0 24 24">
                    <path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"/>
                </svg>
                <span>{{ article.category|join(', ') }}</span>
            </p>
        </div>
    </div>

    <div class="article-body">
        {% if article.image_url %}
        <div class="article-image">
            <img src="{{ article.image_url }}" alt="{{ article.title }}" class="fade-in">
        </div>
        {% endif %}

        <div class="article-content">
            {{ article.content|safe }}
        </div>
    </div>
    <div class="article-footer">
        {% if session.user_id|string == article.author_id|string %}
        <div class="article-actions">
            <a href="{{ url_for('edit_article', article_id=article._id) }}" class="btn btn-primary">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                </svg>
                Edit Article
            </a>
        </div>
        {% endif %}

        <div class="share-buttons">
            <button class="share-btn" data-platform="twitter" aria-label="Share on Twitter">
                <svg class="icon" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/></svg>
            </button>
            <button class="share-btn" data-platform="facebook" aria-label="Share on Facebook">
                <svg class="icon" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>
            </button>
            <button class="share-btn" data-platform="linkedin" aria-label="Share on LinkedIn">
                <svg class="icon" viewBox="0 0 24 24"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
            </button>
        </div>
    </div>
</div>

<div class="floating-action-button" id="back-to-top">
    <svg class="icon"><use xlink:href="#arrow-up-icon"></use></svg>
</div>

<div class="reactions">
    <button class="reaction-btn" data-reaction="like">
        <svg class="icon" viewBox="0 0 24 24"><path d="M14 9V5l7 7-7 7v-4.1c-5 0-8.5 1.6-11 5.1 1-5 4-10 11-11z"/></svg>
        <span class="reaction-count">0</span>
    </button>
    <button class="reaction-btn" data-reaction="love">
        <svg class="icon" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
        <span class="reaction-count">0</span>
    </button>
    <button class="reaction-btn" data-reaction="clap">
        <svg class="icon" viewBox="0 0 24 24"><path d="M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"/></svg>
        <span class="reaction-count">0</span>
    </button>
</div>

<style>
    .article-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background-color: #f8f9fa;
        border-top: 1px solid #e9ecef;
    }

    .btn-primary {
        display: inline-flex;
        align-items: center;
        background-color: #007bff;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
        transition: background-color 0.3s ease;
    }

    .btn-primary:hover {
        background-color: #0056b3;
    }

    .btn-primary .icon {
        width: 20px;
        height: 20px;
        margin-right: 10px;
        fill: currentColor;
    }

    .share-buttons {
        display: flex;
        gap: 10px;
    }

    .share-btn {
        background-color: #f8f9fa;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .share-btn:hover {
        background-color: #e9ecef;
    }

    .share-btn .icon {
        width: 20px;
        height: 20px;
        fill: #6c757d;
    }

    .floating-action-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #007bff;
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        transition: background-color 0.3s ease, transform 0.3s ease;
    }

    .floating-action-button:hover {
        background-color: #0056b3;
        transform: scale(1.1);
    }

    .floating-action-button .icon {
        width: 24px;
        height: 24px;
        fill: white;
    }

    .reactions {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
    }

    .reaction-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        background: none;
        border: none;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .reaction-btn:hover {
        transform: scale(1.1);
    }

    .reaction-btn .icon {
        width: 30px;
        height: 30px;
        fill: #6c757d;
        transition: fill 0.3s ease;
    }

    .reaction-btn:hover .icon {
        fill: #007bff;
    }

    .reaction-count {
        font-size: 14px;
        color: #6c757d;
        margin-top: 5px;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }

    .pulse {
        animation: pulse 0.5s ease-in-out;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const shareButtons = document.querySelectorAll('.share-btn');
    shareButtons.forEach(button => {
        button.addEventListener('click', function() {
            const platform = this.dataset.platform;
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent(document.title);
            let shareUrl;

            switch(platform) {
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
                    break;
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                    break;
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}`;
                    break;
            }

            window.open(shareUrl, '_blank');
        });
    });

    const reactionButtons = document.querySelectorAll('.reaction-btn');
    reactionButtons.forEach(button => {
        button.addEventListener('click', function() {
            const countElement = this.querySelector('.reaction-count');
            let count = parseInt(countElement.textContent);
            count++;
            countElement.textContent = count;
            this.classList.add('pulse');
            setTimeout(() => this.classList.remove('pulse'), 500);
        });
    });
});
</script>

<div class="floating-action-button" id="back-to-top">
    <svg class="icon"><use xlink:href="#arrow-up-icon"></use></svg>
</div>

<svg style="display: none;">
    <symbol id="user-icon" viewBox="0 0 24 24">
        <path d="M12 12a4 4 0 100-8 4 4 0 000 8zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
    </symbol>
    <symbol id="calendar-icon" viewBox="0 0 24 24">
        <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
    </symbol>
    <symbol id="tag-icon" viewBox="0 0 24 24">
        <path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>
    </symbol>
    <symbol id="twitter-icon" viewBox="0 0 24 24">
        <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    </symbol>
    <symbol id="facebook-icon" viewBox="0 0 24 24">
        <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
    </symbol>
    <symbol id="linkedin-icon" viewBox="0 0 24 24">
        <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-4 0v7h-4v-7a6 6 0 0 1 6-6zM2 9h4v12H2zm2-7a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/>
    </symbol>
    <symbol id="arrow-up-icon" viewBox="0 0 24 24">
        <path d="M12 3l-6 6h4v10h4V9h4z"/>
    </symbol>
</svg>

<style>
    body {
        background-color: #f0f2f5;
        font-family: 'Arial', sans-serif;
    }
    .article-container {
        max-width: 800px;
        margin: 40px auto;
        background-color: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        overflow: hidden;
    }
    .article-header {
        background-color: #007bff;
        color: white;
        padding: 40px;
        position: relative;
    }
    .article-header::after {
        content: '';
        position: absolute;
        bottom: -20px;
        left: 0;
        right: 0;
        height: 40px;
        background-color: white;
        clip-path: polygon(0 0, 100% 0, 100% 100%, 0 0);
    }
    .article-title {
        font-family: 'Georgia', serif;
        margin-bottom: 20px;
        font-size: 2.5em;
    }
    .article-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
    }
    .article-meta p {
        margin: 0;
        display: flex;
        align-items: center;
        background-color: #e9ecef;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.9em;
    }
    .article-body {
        padding: 40px;
    }
    .article-image img {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease-in-out;
    }
    .article-image img:hover {
        transform: scale(1.02);
    }
    .article-content {
        font-size: 1.1em;
        line-height: 1.8;
        position: relative;
    }
    .article-content::first-letter {
        font-size: 3em;
        font-weight: bold;
        color: #007bff;
        float: left;
        line-height: 1;
        padding-right: 8px;
    }
    .article-footer {
        background-color: #f8f9fa;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .share-buttons {
        display: flex;
        gap: 10px;
    }
    .share-btn, .back-to-top {
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        transition: background-color 0.3s, transform 0.3s;
    }
    .share-btn:hover, .back-to-top:hover {
        background-color: rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
    }
    .share-btn .icon, .back-to-top .icon {
        width: 24px;
        height: 24px;
        fill: currentColor;
    }
    .share-btn[data-platform="twitter"] { color: #1da1f2; }
    .share-btn[data-platform="facebook"] { color: #1877f2; }
    .share-btn[data-platform="linkedin"] { color: #0077b5; }
    .back-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #007bff;
        color: white;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        opacity: 0;
        pointer-events: none;
    }
    .back-to-top.visible {
        opacity: 1;
        pointer-events: auto;
    }
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    .fade-in-up {
        animation: fadeInUp 0.5s ease-out;
    }
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    .icon {
        width: 20px;
        height: 20px;
        fill: currentColor;
        transition: transform 0.2s ease-in-out;
    }
    .icon:hover {
        transform: scale(1.1);
    }
    .icon-user { color: #007bff; }
    .icon-calendar { color: #28a745; }
    .icon-tag { color: #ffc107; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const title = document.querySelector('.article-title');
    title.style.opacity = '0';
    title.style.transform = 'translateY(-20px)';
    title.style.transition = 'opacity 0.5s, transform 0.5s';
    
    setTimeout(() => {
        title.style.opacity = '1';
        title.style.transform = 'translateY(0)';
    }, 100);

    const metaItems = document.querySelectorAll('.article-meta p');
    metaItems.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateX(-20px)';
        item.style.transition = `opacity 0.5s ${index * 0.1}s, transform 0.5s ${index * 0.1}s`;
        
        setTimeout(() => {
            item.style.opacity = '1';
            item.style.transform = 'translateX(0)';
        }, 300 + index * 100);
    });

    const content = document.querySelector('.article-content');
    content.style.opacity = '0';
    content.style.transform = 'translateY(20px)';
    content.style.transition = 'opacity 0.5s, transform 0.5s';
    
    setTimeout(() => {
        content.style.opacity = '1';
        content.style.transform = 'translateY(0)';
    }, 500);

    const shareButtons = document.querySelectorAll('.share-btn');
    shareButtons.forEach((btn, index) => {
        btn.classList.add('fade-in-up');
        btn.style.animationDelay = `${0.7 + index * 0.1}s`;
    });

    shareButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const platform = this.getAttribute('data-platform');
            alert(`Sharing on ${platform} (This is a placeholder action)`);
        });
    });

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });

    // Animate article title underline
    const title = document.querySelector('.article-title');
    title.addEventListener('mouseenter', () => {
        title.style.setProperty('--underline-width', '100%');
    });
    title.addEventListener('mouseleave', () => {
        title.style.setProperty('--underline-width', '0%');
    });

    // Parallax effect for article image
    const articleImage = document.querySelector('.article-image img');
    if (articleImage) {
        window.addEventListener('scroll', () => {
            const scrollPosition = window.pageYOffset;
            articleImage.style.transform = `translateY(${scrollPosition * 0.2}px)`;
        });
    }

    // Back to top button
    const backToTopButton = document.getElementById('back-to-top');
    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
            backToTopButton.classList.add('visible');
        } else {
            backToTopButton.classList.remove('visible');
        }
    });
    backToTopButton.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Highlight text on selection
    document.querySelector('.article-content').addEventListener('mouseup', function() {
        const selection = window.getSelection();
        if (selection.toString().length > 0) {
            const range = selection.getRangeAt(0);
            const span = document.createElement('span');
            span.className = 'highlight';
            span.style.backgroundColor = '#ffff00';
            span.style.transition = 'background-color 0.3s';
            range.surroundContents(span);
        }
    });

    // Add a reading progress bar
    const progressBar = document.createElement('div');
    progressBar.style.position = 'fixed';
    progressBar.style.top = '0';
    progressBar.style.left = '0';
    progressBar.style.height = '3px';
    progressBar.style.backgroundColor = '#007bff';
    progressBar.style.transition = 'width 0.1s';
    document.body.appendChild(progressBar);

    window.addEventListener('scroll', () => {
        const scrollPosition = window.pageYOffset;
        const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
        const progress = (scrollPosition / totalHeight) * 100;
        progressBar.style.width = `${progress}%`;
    });
});
</script>
{% endblock %}